# ============================================
# X (Twitter) 平台爬虫配置
# ============================================
#
# 使用：docker-compose -f docker-compose.yml -f docker-compose.x.yml up -d
#
# ============================================

# YAML 锚点 - 复用配置
x-x-crawler-base: &x-crawler-base
  image: ghcr.io/${GITHUB_USERNAME}/crawler:latest
  restart: unless-stopped
  labels:
    - "com.centurylinklabs.watchtower.enable=true"
    - "com.centurylinklabs.watchtower.stop-timeout=60s"
    - "platform=x"  # 平台标签
  networks:
    - crosshot

services:
  # ============================================
  # X 平台 Crawler 实例
  # ============================================

  # AI 相关话题
  crawler-x-ai:
    <<: *x-crawler-base
    container_name: crawler-x-ai
    volumes:
      - ./data/x/ai:/app/data
      - ./logs/x/ai:/app/logs
    environment:
      - ENV=production
      - LOG_LEVEL=INFO
      - PLATFORM=x
      - KEYWORDS=AI,Machine Learning,GPT,Claude,LLM
      - MAX_RESULTS=100
      - INTERVAL=3600  # 1 小时

  # Python 开发
  crawler-x-python:
    <<: *x-crawler-base
    container_name: crawler-x-python
    volumes:
      - ./data/x/python:/app/data
      - ./logs/x/python:/app/logs
    environment:
      - ENV=production
      - LOG_LEVEL=INFO
      - PLATFORM=x
      - KEYWORDS=Python,Django,FastAPI,Flask
      - MAX_RESULTS=100
      - INTERVAL=3600

  # Web3 区块链
  crawler-x-web3:
    <<: *x-crawler-base
    container_name: crawler-x-web3
    volumes:
      - ./data/x/web3:/app/data
      - ./logs/x/web3:/app/logs
    environment:
      - ENV=production
      - LOG_LEVEL=INFO
      - PLATFORM=x
      - KEYWORDS=Blockchain,Web3,Crypto,DeFi
      - MAX_RESULTS=50
      - INTERVAL=7200  # 2 小时

  # ============================================
  # 自动更新由 Portainer Webhook 处理
  # 参见: docs/AUTO_UPDATE_SOLUTIONS.md
  # ============================================
  #
  # Watchtower 已移除（API 版本不兼容）
  # 使用 GitHub Actions + Portainer Webhook 替代
  #
  # ============================================

# ============================================
# 添加更多 X 平台 Crawler
# ============================================
#
# 复制上面的配置，修改：
# 1. container_name: crawler-x-你的主题
# 2. volumes: ./data/x/你的主题
# 3. KEYWORDS: 你的关键词
# 4. INTERVAL: 爬取间隔
#
# 示例：
#
#   crawler-x-design:
#     <<: *x-crawler-base
#     container_name: crawler-x-design
#     volumes:
#       - ./data/x/design:/app/data
#       - ./logs/x/design:/app/logs
#     environment:
#       - PLATFORM=x
#       - KEYWORDS=UI,UX,Design,Figma
#       - MAX_RESULTS=50
#       - INTERVAL=7200
#
# ============================================
